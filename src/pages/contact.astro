---
import Layout from '../layouts/Layout.astro';
import ContactForm from '../components/ContactForm.astro';
import { actions } from 'astro:actions';

/* dynamically generate the contact page */
export const prerender = false; 

const result = Astro.getActionResult(actions.contact);

// Redirect to clean URL after successful form submission
if (Astro.request.method === 'POST' && result) {
  return Astro.redirect('/contact?success=true');
}

// Check if we were redirected after success
const successParam = Astro.url.searchParams.get('success');
const showSuccess = successParam === 'true';
---

<Layout>
  <main class="container mx-auto px-4 py-16 max-w-2xl">
    <div class="space-y-8">
      <div class="text-center space-y-4">
        <h1 class="text-4xl font-bold tracking-tight">Get in Touch</h1>
        <p class="text-muted-foreground text-lg">
          Have a question or want to work together? Send us a message and we'll get back to you as soon as possible.
        </p>
      </div>

      {showSuccess && (
        <div class="rounded-md p-4 bg-green-500/15 text-green-700 dark:text-green-400" role="status">
          <p class="font-medium">Success!</p>
          <p class="text-sm">Thank you for your message! We will get back to you soon.</p>
        </div>
      )}

      <div class="rounded-lg border bg-card p-8 shadow-sm">
        <ContactForm />
      </div>
    </div>
  </main>
</Layout>
